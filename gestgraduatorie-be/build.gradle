/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    id 'org.springframework.boot' version "2.3.1.RELEASE"
}

repositories {
    mavenLocal()
    mavenCentral()
    maven {
	url "https://build.shibboleth.net/nexus/content/repositories/releases/"
    }	
    maven {
	url "http://jaspersoft.jfrog.io/jaspersoft/third-party-ce-artifacts/"
    }
    maven {
        mavenContent {
            releasesOnly()
        }
        url = uri("${gradle.mavenReleasesRepoUrl}")
        credentials {
                username = "${gradle.mavenCredentialsUsername}"
                password = "${gradle.mavenCredentialsPassword}"
            }
    }
    maven {
        mavenContent {
            snapshotsOnly()
        }
        url = uri("${gradle.mavenSnapshotsRepoUrl}");
        credentials {
                username = "${gradle.mavenCredentialsUsername}"
                password = "${gradle.mavenCredentialsPassword}"
            }
    }
	flatDir {
	       dirs 'libs'
	   }
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa:2.3.1.RELEASE'
    implementation 'org.springframework.boot:spring-boot-starter-web:2.3.1.RELEASE'
    implementation 'org.springframework.boot:spring-boot-starter-validation:2.3.1.RELEASE'
    implementation 'org.springframework.boot:spring-boot-starter-tomcat:2.3.1.RELEASE'
    //implementation 'org.springframework.boot:spring-boot-starter-quartz:2.3.1.RELEASE'
	implementation 'org.springframework.boot:spring-boot-starter-security:2.3.1.RELEASE'
	
	implementation 'org.springframework.security.extensions:spring-security-saml2-core:1.0.10.RELEASE'
	implementation 'com.nimbusds:nimbus-jose-jwt:8.19'
	implementation "org.jdbi:jdbi3-spring4:3.14.1"
	implementation "org.jdbi:jdbi3-sqlobject:3.14.1"
	implementation "org.jdbi:jdbi3-stringtemplate4:3.14.1"
    implementation 'io.springfox:springfox-swagger-ui:2.9.2'
    implementation 'io.springfox:springfox-swagger2:2.9.2'
    implementation 'org.apache.commons:commons-lang3:[3.8,)'
    implementation 'org.modelmapper:modelmapper:2.3.6'
    implementation 'com.opencsv:opencsv:4.6'
    implementation 'org.glassfish.jersey.core:jersey-client:2.30'
    implementation 'org.glassfish.jersey.inject:jersey-hk2:2.30'
    implementation 'org.glassfish.jersey.media:jersey-media-json-jackson:2.30'
    implementation 'com.mchange:c3p0:0.9.5.4'
    implementation 'ch.qos.logback:logback-classic:1.2.3'
    implementation 'net.logstash.logback:logstash-logback-encoder:5.2'
	implementation 'net.sf.jasperreports:jasperreports:6.16.0'
	implementation 'org.apache.poi:poi:4.1.1'
	implementation 'org.apache.poi:poi-ooxml:4.1.1'
	implementation 'org.json:json:20190722'
	implementation 'com.amazonaws:aws-java-sdk:1.11.163'
	implementation 'org.javaswift:joss:0.9.13'
	implementation 'it.regioneveneto.myp3:my-box:0.0.5-SNAPSHOT'
	//compile 'com.lowagie:itext:2.1.7'
    compile 'org.apache.httpcomponents:httpclient:4.5.13'
    implementation 'joda-time:joda-time:2.10.6'
    implementation project (':gestgraduatorie-fe')
    runtimeOnly 'org.postgresql:postgresql:42.2.9'
    testImplementation 'org.springframework.boot:spring-boot-starter-test:2.3.1.RELEASE'
	compileOnly 'org.projectlombok:lombok:1.18.12'
	annotationProcessor 'org.projectlombok:lombok:1.18.12'
    compileOnly 'org.springframework.boot:spring-boot-devtools:2.3.1.RELEASE'

    compile('com.sun.xml.fastinfoset:FastInfoset'){
        version{
            strictly '1.2.16'
        }
    }
    compile('net.bytebuddy:byte-buddy'){
       version{
           strictly '1.10.6'
       }
    }
    compile('org.apache.commons:commons-lang3'){
        version{
            strictly '3.10'
        }
    }
    compile('com.sun.istack:istack-commons-runtime'){
        version {
            strictly '3.0.8'
        }
    }
    compile('com.fasterxml.jackson.module:jackson-module-jaxb-annotations') {
        version{
            strictly '2.10.2'
        }
    }
    compile('jakarta.xml.bind:jakarta.xml.bind-api'){
       version {
           strictly '2.3.2'
       }
    }
    compile('org.glassfish.jaxb:jaxb-runtime'){
        version {
            strictly '2.3.2'
        }
    }
    compile('org.jboss.logging:jboss-logging'){
        version{
            strictly '3.4.1.Final'
        }
    }
    compile('org.jvnet.staxex:stax-ex'){
        version{
            strictly '1.8.1'
        }
    }
    compile('org.glassfish.jaxb:txw2'){
        version{
            strictly '2.3.2'
        }
    }
}

configurations {
    compile.exclude module: 'tomcat-annotations-api'
    all*.exclude group: 'xml-apis'
    
    [apiElements, runtimeElements].each {
       it.outgoing.artifacts.removeIf { it.buildDependencies.getDependencies(null).contains(jar) }
       it.outgoing.artifact(bootJar)
    }
   
} 

group = 'it.regioneveneto.myp3'
version = '0.0.1'
description = 'gestione graduatorie - Java bootable jar'
sourceCompatibility = '11'

publish {
    dependsOn assemble
}

publishToMavenLocal {
    dependsOn assemble
}

def configurePublishingRepositories(repositoryHandler, version) {
    
    repositoryHandler.maven {
        def releasesRepoUrl = "${gradle.mavenReleasesRepoUrl}"
        def snapshotsRepoUrl = "${gradle.mavenSnapshotsRepoUrl}"
        url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
        credentials {
            username = "${gradle.mavenCredentialsUsername}"
            password = "${gradle.mavenCredentialsPassword}"
        }
    }
}

publishing {
    publications {
        maven(MavenPublication) {
            artifactId="${project.name}"
            from(components.java)
        }
    }
    repositories {
        configurePublishingRepositories(delegate, version)
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

bootRun {
  jvmArgs=["-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=32323"]
}
